
# 2. worthy.knight

## Solution: 

We use ghidra and see that the entry function is primarily just calling the function FUN_001010d0.

Looking further at FUN_001010d0, we can clearly see that the input needs to be of 10 characters.

There is a loop that checks the input characters in pairs, the loop also makes sure the characters are all alphabetic using
```
        if (((uVar2 & 0x400) == 0) || (uVar3 = (*ppuVar7)[pbVar 8[1]], (uVar3 & 0x400) == 0)) {
          puts("\nThe runes fail to align. The incantation is impure. ");
```

and that both both alphabets are of the opposite case using 
```
        if ((((uVar2 & 0x100) != 0) && ((uVar3 & 0x100) != 0)) ||
           (((uVar2 & 0x200) != 0 && ((uVar3 & 0x200) != 0)))) {
          puts("\nThe ancient seals do not resonate with your runes. ");
```

Ater this we can start building the right input since for each pair, one of the alphabets is given and the other alphabet can be found using XOR.

For example for the first pair -
```
      if ((byte)(local_c8[1] ^ local_c8[0]) == 0x24) {
        if (local_c8[1] == 0x6a) {
```

We can observe that the second character is `0x6a` which is `j` and the first character can be found using `0x6a XOR 0x24 = 0x4e` which gives us the first character to be `N`.
The first pair is `Nj` similarly we can find pairs 2, 4 and 5.

But for pair 3, the code changes, it takes the charcters at 4th and 5th position, then swaps their order and finds the MD5 hash of the pair then compares it against the value `33a3192ba92b5a4803c9a9ed70ea5a9c`. 
Since we know that only alphabets are to be used, I brute-forced this and found the match to be `Tf`, which means the 3rd pair is `fT`.

Now combining all the pairs we get the correct input to be NjkSfTYaIi.

```
cookorcooked@ubuntu25:~/Desktop/Curated/worthy.knight$ ./worthy.knight
                       (Knight's Adventure)                

         O                                              
        <M>            .---.                            
        /W\           ( -.- )--------.                  
   ^    \|/            \_o_/         )    ^             
  /|\    |     *      ~~~~~~~       /    /|\            
  / \   / \  /|\                    /    / \            
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Welcome, traveler. A mighty dragon blocks the gate.
Speak the secret incantation (10 runic letters) to continue.

Enter your incantation: NjkSfTYaIi

   The kingdom's gates open, revealing the hidden realm...    
                         ( (                                 
                          \ \                                
                     .--.  ) ) .--.                         
                    (    )/_/ (    )                        
                     '--'      '--'                         
    "Huzzah! Thy incantation is true. Onward, brave knight!" 

The final scroll reveals your reward: KCTF{NjkSfTYaIi}

```
And hence our flag is found.

## Flag:

```
KCTF{NjkSfTYaIi}
```

## Concepts learnt:

- Learnt how some complicated looking codes can be solved using simple logic when you actually understand it.

## Notes:

- NONE
  
## Resources:

- NONE

***

